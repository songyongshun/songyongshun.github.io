import math

# filepath: c:\Users\Lenovo\docf\ciit\python-course\ch10\exer-try-except-practice.py
# %% [markdown]
# Python 异常处理练习题（循序渐进）

# %% [markdown]
# 练习1：基础异常捕获
# 以下代码会报错，用 try-except 捕获并打印 "发生错误"
# %%
try:
  5 / 0
except:
  print("发生错误")

# %% [markdown]
# 练习2：捕获特定异常
# 捕获 ZeroDivisionError，并打印 "不能除以零"
# %%
try:
  5 / 0
except ZeroDivisionError:
  print("不能除以零")

# %% [markdown]
# 练习3：多个异常类型
# 输入一个字符串，尝试转为整数。捕获 ValueError 和 TypeError
# %%
try:
  num = int("abc")
except :  # 1.TODO
  print("输入的不是有效数字")
except TypeError:
  print("类型错误")

# %% [markdown]
# 练习4：使用 else 和 finally
# 输入一个数字，尝试计算平方根。成功时打印结果，失败时提示错误，无论成败都打印“操作结束”
# %%
try:
  x = int(input("请输入一个数字: "))
  result = math.sqrt(x)
except ValueError:
  print("请输入有效数字")
else:
  print(f"平方根是: {result}")
:  # 2. TODO
  print("操作结束")

# %% [markdown]
# 练习5：读取不存在的文件
# 尝试打开一个不存在的文件，捕获 FileNotFoundError 并提示“文件未找到”
# %%
try:
  with open("nonexistent.txt", "r") as f:
    content = f.read()
except FileNotFoundError:
  # 3. TODO

# %% [markdown]
# 练习6：处理列表索引越界
# 创建一个列表 [1,2,3]，尝试访问索引 5，捕获 IndexError
# %%
my_list = # 4. TODO
try:
  print(my_list[5])
except IndexError:
  print("索引超出范围")

# %% [markdown]
# 练习7：嵌套异常处理
# 在 try 块中调用一个函数，该函数内部可能抛出异常，外层捕获并处理
# %%
def risky_function():
  return 10 / int(input("输入一个非零数字: "))

try:
  result =   # 5. TODO
  print(f"结果: {result}")
except ZeroDivisionError:
  print("不能除以零")
except ValueError:
  print("输入无效")

# %% [markdown]
# 练习8：捕获多个异常到同一处理块
# 尝试执行以下操作：访问字典不存在的键、除零、列表越界，统一用一个 except 处理
# %%
data = {"a": 1}
try:
  value = data["b"]
  result = 5 / 0
  item = [1,2][5]
except (KeyError, ZeroDivisionError, IndexError):
  print("发生了一个已知错误")

# %% [markdown]
# 练习9：获取异常信息
# 捕获异常时，打印异常的具体类型和信息
# %%
try:
  num = int("hello")
except Exception as : # 6. TODO
  print(f"异常类型: {type(e).__name__}")
  print(f"异常信息: {e}")

# %% [markdown]
# 练习10：综合应用 - 安全计算器
# 实现一个简单计算器，支持加减乘除，输入非数字或除零时提示错误，不崩溃
# %%
def safe_calculator():
  try:
    a = float(input("请输入第一个数: "))
    op = input("请输入运算符 (+, -, *, /): ")
    b = float(input("请输入第二个数: "))
    
    if op == "+":
      result = a + b
    elif op == "-":
      result = a - b
    elif op == : # 7. TODO
      result = a * b
    elif op == "/":
      if b == 0:
        print("除数不能为零")
        return
      result = a / b
    else:
      print("不支持的运算符")
      return
    
    print(f"结果: {result}")
  except ValueError:
    print("输入不是有效数字")
  except Exception:
    print("未知错误")

# 运行测试
safe_calculator()
